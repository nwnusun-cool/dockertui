# DockTUI 开发任务清单

> 最后更新：2026-01-09

## 📊 完成进度概览

| 模块 | 状态 | 完成度 |
|------|------|--------|
| 基础架构 | ✅ 完成 | 100% |
| Docker 客户端 | ✅ 完成 | 100% |
| 容器管理 | ✅ 完成 | 100% |
| 镜像管理 | 🔄 进行中 | 80% |
| Compose 支持 | 🔄 进行中 | 40% |
| 网络管理 | ⏳ 计划中 | 0% |
| 卷管理 | ⏳ 计划中 | 0% |

---

## ✅ 已完成功能

### 阶段 A：基础架构（100%）

- [x] MVP 范围确定
- [x] 技术栈选型（Bubble Tea + Docker SDK）
- [x] 模块边界设计
- [x] 项目骨架搭建
- [x] 依赖管理
- [x] 配置加载

### 阶段 B：Docker 客户端层（100%）

- [x] Docker SDK 集成
- [x] 客户端接口定义
- [x] 容器列表 API (ListContainers)
- [x] 容器详情 API (InspectContainer)
- [x] 容器日志 API (ContainerLogs)
- [x] 容器操作 API (Start/Stop/Restart/Pause/Unpause/Remove)
- [x] Exec Shell API
- [x] 资源统计 API (Stats)
- [x] 镜像列表 API (ListImages)
- [x] 镜像详情 API (InspectImage)
- [x] 镜像操作 API (Remove/Prune/Pull)
- [x] 镜像拉取进度 API (PullImageWithProgress)

### 阶段 C：TUI 框架（100%）

- [x] Bubble Tea 主程序入口
- [x] 全局状态管理
- [x] 视图切换框架
- [x] 快捷键映射系统
- [x] 颜色自适应（亮色/暗色终端）
- [x] 弹窗和对话框组件
- [x] 后台任务管理器
- [x] 任务进度条组件

### 阶段 D：容器管理（100%）

- [x] 首页导航视图
- [x] 容器列表视图
  - [x] 表格显示（状态着色）
  - [x] vim 风格导航
  - [x] 搜索功能
  - [x] 自动刷新
  - [x] 动态列宽
- [x] 容器详情视图
  - [x] 6 个标签页（基本信息、资源监控、网络端口、存储挂载、环境变量、标签）
  - [x] 标签页切换
  - [x] 资源监控图表
- [x] 容器日志视图
  - [x] Follow 模式
  - [x] 自动换行
  - [x] 日志着色
  - [x] vim 风格滚动
- [x] 容器操作
  - [x] 启动/停止/重启
  - [x] 暂停/恢复
  - [x] 删除（带确认对话框）
- [x] 交互式 Shell
  - [x] Shell 选择器
  - [x] 退出后返回 TUI

### 阶段 E：镜像管理（80%）

- [x] 镜像列表视图
  - [x] 表格显示（状态着色）
  - [x] 水平滚动支持
  - [x] 搜索功能
  - [x] 动态列宽
- [x] 镜像详情视图
  - [x] 6 个标签页
- [x] 镜像操作
  - [x] 删除镜像（普通/强制）
  - [x] 清理悬垂镜像
  - [x] 拉取镜像（带进度条）
- [ ] 镜像打标签
- [ ] 镜像取消标签
- [ ] 镜像导出
- [ ] 镜像导入
- [ ] 镜像推送

### 阶段 F：Compose 支持（40%）

- [x] Compose 客户端封装
- [x] 项目扫描
- [x] 项目列表视图
- [x] 基本操作（up/down/restart）
- [ ] 项目详情视图
- [ ] 服务列表
- [ ] 项目日志
- [ ] 容器联动

---

## 🔄 进行中任务

### 镜像管理完善

- [ ] **I5.3：实现打标签功能**
  - 按 `t` 为选中镜像打标签
  - 弹出输入框输入仓库名和标签
  
- [ ] **I5.4：实现取消标签功能**
  - 按 `u` 删除选中镜像的标签

- [ ] **I6：镜像导入导出**
  - 导出镜像到 tar 文件
  - 从 tar 文件加载镜像

### Compose 功能完善

- [ ] **C5：Compose 项目详情视图**
  - 服务列表标签页
  - 配置信息标签页
  - 网络/卷信息

- [ ] **C6：Compose 日志视图**
  - 项目级日志聚合
  - 服务级日志查看

- [ ] **C7：容器联动**
  - 按项目过滤容器
  - 从项目跳转到容器

---

## ⏳ 计划中任务

### 网络管理（N 系列）

- [ ] **N1：网络列表视图**
- [ ] **N2：网络详情视图**
- [ ] **N3：创建网络**
- [ ] **N4：删除网络**

### 卷管理（V 系列）

- [ ] **V1：卷列表视图**
- [ ] **V2：卷详情视图**
- [ ] **V3：创建卷**
- [ ] **V4：删除卷**
- [ ] **V5：清理未使用卷**

### 用户体验优化（R 系列）

- [ ] **R1：统一错误处理**
- [ ] **R2：配置文件支持**
- [ ] **R3：主题定制**
- [ ] **R4：多语言支持**

### 高级功能（A 系列）

- [ ] **A1：多主机支持**
- [ ] **A2：容器日志导出**
- [ ] **A3：批量操作**
- [ ] **A4：容器模板**

---

## 📋 已知问题

1. ~~镜像拉取进度条不更新~~ ✅ 已修复
2. ~~拉取输入框中输入特定字符会触发全局快捷键~~ ✅ 已修复
3. ~~ESC 键在弹窗显示时直接返回上一级~~ ✅ 已修复

---

## 🎯 下一步计划

1. 完成镜像打标签/取消标签功能
2. 完善 Compose 项目详情视图
3. 实现网络管理基础功能
4. 实现卷管理基础功能

---

## 📝 开发笔记

### 架构决策

1. **TUI 框架选择 Bubble Tea**：相比 tcell，Bubble Tea 提供了更好的组件化支持和状态管理
2. **Docker SDK vs CLI**：使用官方 Go SDK，但 Shell 功能使用 docker exec 命令以获得更好的兼容性
3. **Compose 集成**：优先使用 `docker compose`（v2），回退到 `docker-compose`

### 代码规范

1. 视图文件命名：`xxx_view.go`
2. 消息类型命名：`xxxMsg`
3. 快捷键定义集中在 `keys.go`
4. 样式定义在各视图文件顶部

### 测试建议

1. 准备多种状态的容器（运行中、停止、暂停）
2. 准备悬垂镜像用于测试清理功能
3. 测试大量容器/镜像时的性能
4. 测试不同终端（Windows Terminal、iTerm2、Linux Terminal）
