## MVP 详细任务清单（本地 Docker + docker-compose + 容器列表 + 日志 + exec）

> 说明：每个任务和子任务都是一个清单项，带有数字 ID、简要上下文和依赖的任务 ID，方便开发者按依赖顺序实施。

---

### 阶段 A：需求与架构收敛（T 系列）

- [√] **1 T1：锁定 MVP 范围与用例**  
  说明：从整体 PRD 中收敛出当前阶段仅实现“本地 Docker + 本地 docker-compose + 容器列表 + 日志 + exec + compose 项目管理”的范围，确保团队共识一致。  
  依赖：无
  - [√] **1.1 T1.1：整理与 MVP 相关的需求说明**  
    说明：从 PRD 中提取与本地 Docker、本地 docker-compose、容器列表、日志、exec 相关部分，整理成 1 页简版 MVP 说明（不含多主机、Playbook 等远期扩展）。  
    依赖：1
  - [√] **1.2 T1.2：列出 MVP 的核心用例列表**  
    说明：形成用例列表，如“查看容器列表”“查看容器详情”“查看/跟随日志”“进入容器 shell 并退出后返回工具”“扫描 & 管理 docker-compose 项目”等，为后续设计提供输入。  
    依赖：1

- [√] **2 T2：确定技术栈细节**  
  说明：为 MVP 锁定具体技术栈（Go 版本、TUI 框架、Docker SDK、docker-compose 调用方式），避免中途切换技术方案。  
  依赖：1
  - [√] **2.1 T2.1：确定 TUI 框架（Bubble Tea 或 tcell）**  
    说明：评估 Bubble Tea 与 tcell，确认首版使用 Bubble Tea（配合 bubbles/lipgloss），记录选择理由。  
    依赖：2
  - [√] **2.2 T2.2：确定 Docker 接口（官方 Go SDK / Docker Engine API）**  
    说明：选择使用官方 Docker Go SDK 或直接调用 HTTP API，考虑到本地环境（Windows + Docker Desktop）的兼容性。  
    依赖：2
  - [√] **2.3 T2.3：确定 docker-compose 集成方式**  
    说明：决定使用 `docker compose` 还是 `docker-compose` CLI 进行集成，并明确通过 `os/exec` 调用 CLI 的基本策略。  
    依赖：2

- [√] **3 T3：模块边界设计**  
  说明：在实现前明确 `internal/ui`、`internal/docker`、`internal/config` 等模块的职责和依赖关系，并预留 docker-compose 支持位置。  
  依赖：1, 2
  - [√] **3.1 T3.1：绘制简化架构图**  
    说明：画出包含 UI 层、Docker 客户端层、配置层、docker-compose 封装的简化架构图（可用 markdown 或简单注释），用于沟通与后续扩展。  
    依赖：3
  - [√] **3.2 T3.2：明确模块职责与依赖**  
    说明：用文字说明每个模块负责的内容以及谁可以依赖谁（例如 `internal/ui` 只能通过接口使用 `internal/docker` 和 compose 封装）。  
    依赖：3

---

### 阶段 B：项目基础设施与依赖（B 系列）

- [√] **4 B1：项目骨架确认与整理**  
  说明：确保项目结构符合预期，入口文件和 internal 目录结构清晰可用。  
  依赖：3
  - [√] **4.1 B1.1：检查 go.mod module 名**  
    说明：确认 `go.mod` 中的 module 名是否符合将来托管路径（例如 `github.com/yourname/docktui`），避免后期大规模重构导入路径。  
    依赖：4
  - [√] **4.2 B1.2：检查 main.go 入口结构**  
    说明：确认 `cmd/docktui/main.go` 已预留 TUI 初始化位置，并删除不必要的示例代码。  
    依赖：4
  - [√] **4.3 B1.3：确认目录结构完整性**  
    说明：检查 `internal/ui`、`internal/docker`、`internal/config` 是否已创建，并符合架构设计。  
    依赖：4

- [√] **5 B2：依赖管理**  
  说明：引入并锁定 TUI 框架与 Docker SDK 依赖，确保构建环境稳定。  
  依赖：2
  - [√] **5.1 B2.1：添加 TUI 框架依赖**  
    说明：在 `go.mod` 中添加 Bubble Tea 等 TUI 依赖，保证能编译基础 TUI 示例。  
    依赖：5
  - [√] **5.2 B2.2：添加 Docker SDK 依赖**  
    说明：在 `go.mod` 中添加 Docker Go SDK 相关依赖，为后续 Docker 客户端封装做准备。  
    依赖：5
  - [√] **5.3 B2.3：执行 go mod tidy**  
    说明：运行 `go mod tidy`，确保依赖与 go.sum 一致，并验证项目可正常构建。  
    依赖：5

- [√] **6 B3：基础工具与配置**  
  说明：实现最简配置加载能力（例如本地 Docker endpoint 配置），为 Docker 客户端和后续 compose 封装提供配置来源。  
  依赖：4, 5
  - [√] **6.1 B3.1：设计配置结构体**  
    说明：在 `internal/config` 中定义配置 struct（如 Docker 主机地址、超时设置、docker-compose 相关配置），预留扩展空间。  
    依赖：6
  - [√] **6.2 B3.2：实现配置加载逻辑**  
    说明：实现从环境变量或默认值加载配置的函数，确保在本地未配置时也能正常运行。  
    依赖：6
  - [√] **6.3 B3.3：在 main 中集成配置加载**  
    说明：在 `cmd/docktui/main.go` 中调用配置加载函数，并在出错时给出清晰错误信息。  
    依赖：6

---

### 阶段 C：Docker 客户端层（D 系列）

- [√] **7 D1：Docker SDK 调研与最小可行 demo**  
  说明：验证在当前系统（Windows + Docker Desktop）下可以正常通过 Go 代码访问本地 Docker。  
  依赖：6
  - [√] **7.1 D1.1：编写连接 Docker 并打印版本的 demo**  
    说明：编写一个临时代码，连接本地 Docker 并调用 `docker version` 或等价 API，确认通信正常。  
    依赖：7
  - [√] **7.2 D1.2：确认 Windows 环境下 endpoint 配置**  
    说明：验证使用 named pipe 或 TCP endpoint 的配置方式，并记录在文档或注释中。  
    依赖：7

- [√] **8 D2：Docker 客户端封装基础**  
  说明：在 `internal/docker` 中为 Docker 操作提供一个统一的接口层，屏蔽底层 SDK 细节。  
  依赖：7
  - [√] **8.1 D2.1：定义 Docker Client 接口**  
    说明：在 `internal/docker` 中定义包含 `ListContainers`、`ContainerDetails`、`ContainerLogs`、`ExecShell` 等方法的接口。  
    依赖：8
  - [√] **8.2 D2.2：实现本地 localClient 结构**  
    说明：实现针对本地 Docker 的 `localClient`，内部保存 SDK client，并实现接口方法的空壳或基础逻辑。  
    依赖：8
  - [√] **8.3 D2.3：在 main 中初始化 Docker Client**  
    说明：在 `cmd/docktui/main.go` 中根据配置创建 `docker.Client` 实例，验证可以成功创建。  
    依赖：8

- [√] **9 D3：容器列表 API**  
  说明：实现获取本地容器列表的 API，供容器列表视图使用。  
  依赖：8
  - [√] **9.1 D3.1：实现 ListContainers 方法**  
    说明：调用 Docker SDK 获取容器列表，并转换为内部 `Container` 结构（ID、Name、Image、State、Status 等）。  
    依赖：9
  - [√] **9.2 D3.2：为 ListContainers 编写基础测试**  
    说明：使用接口 mock 或假数据编写单元测试，确保列表转换逻辑正确。  
    依赖：9

- [√] **10 D4：容器详情 API**  
  说明：提供按容器 ID 获取详细信息的接口，用于详情视图。  
  依赖：8
  - [√] **10.1 D4.1：定义 ContainerDetails 返回结构**  
    说明：定义包含挂载、端口、环境变量等字段的详情结构体。  
    依赖：10
  - [√] **10.2 D4.2：实现 ContainerDetails 调用**  
    说明：封装 Docker SDK 的 inspect 调用，填充详情结构体。  
    依赖：10

- [√] **11 D5：日志 API**  
  说明：提供容器日志的读取能力，支持一次性获取和 follow 模式。  
  依赖：8
  - [√] **11.1 D5.1：设计日志读取接口**  
    说明：在 Docker Client 接口中定义获取最近 N 行日志和 follow 模式的函数签名。  
    依赖：11
  - [√] **11.2 D5.2：实现日志读取与取消逻辑**  
    说明：实现底层 logs 调用，使用 context 控制超时与取消，保证退出日志视图时能中断读取。  
    依赖：11

- [√] **12 D6：exec shell API**  
  说明：提供在容器内启动交互式 shell 的能力，为后续 TUI 集成做准备。  
  依赖：8
  - [√] **12.1 D6.1：调研 exec/attach 使用方式**  
    说明：阅读 Docker SDK 关于 exec/attach 的示例，明确如何在终端中进行交互式命令执行。  
    依赖：12
  - [√] **12.2 D6.2：实现 ExecShell 方法**  
    说明：在 Docker Client 中实现 `ExecShell`，支持传入容器 ID 和默认 shell 命令。  
    依赖：12

---

### 阶段 D：TUI 框架与主界面（U 系列）

- [√] **13 U1：TUI 程序入口搭建**  
  说明：在 main 中集成 Bubble Tea，形成可运行的基础 TUI 程序入口。  
  依赖：5, 6
  - [√] **13.1 U1.1：创建基础 Model 结构**  
    说明：在 `internal/ui` 中定义主 Model，包含当前视图、全局状态占位等字段。  
    依赖：13
  - [√] **13.2 U1.2：在 main 中启动 Bubble Tea Program**  
    说明：在 `cmd/docktui/main.go` 中使用 `tea.NewProgram` 启动主 Model，并处理启动错误。  
    依赖：13
  - [√] **13.3 U1.3：实现最小 Init/Update/View**  
    说明：实现一个简单界面（如显示欢迎文案，按 q 退出），验证 TUI 主循环工作正常。  
    依赖：13

- [√] **14 U2：全局状态与键盘映射**  
  说明：为全局 TUI 定义状态结构和常用快捷键（退出、切换视图等）。  
  依赖：13
  - [√] **14.1 U2.1：定义全局状态结构体**  
    说明：在 `internal/ui` 中定义保存当前视图、选中容器 ID 等信息的全局 state。  
    依赖：14
  - [√] **14.2 U2.2：设计并实现全局快捷键**  
    说明：在 `Update` 中添加对 `q`、`ctrl+c`、视图切换键（如 `c`、`l` 等）的处理逻辑。  
    依赖：14
  - [√] **14.3 U2.3：为全局状态增加基础错误显示字段**  
    说明：为后续统一错误展示预留字段（如 `errorMsg`），并在 View 中占位。  
    依赖：14

- [√] **15 U3：视图管理框架**  
  说明：抽象不同视图（列表、详情、日志）之间的切换机制。  
  依赖：14, 8
  - [√] **15.1 U3.1：定义 View 接口或抽象**  
    说明：为各视图定义统一接口（如 `Init`, `Update`, `View`），便于主 Model 调度。  
    依赖：15
  - [√] **15.2 U3.2：为列表/详情/日志视图创建空实现**  
    说明：在 `internal/ui` 中为三个视图创建基础 struct 和空方法，实现编译通过。  
    依赖：15
  - [√] **15.3 U3.3：在主 Model 中集成视图切换逻辑**  
    说明：根据当前视图类型调用对应视图的 Update/View，实现简单的视图切换。  
    依赖：15

---

### 阶段 E：容器列表视图（L 系列）

- [√] **16 L1：数据结构与 UI 布局**  
  说明：为容器列表视图设计内部数据模型和基本布局。  
  依赖：15, 9
  - [√] **16.1 L1.1：定义 ContainerListModel**  
    说明：在 `internal/ui` 中定义保存容器列表、选中索引、加载状态、错误信息的 struct。  
    依赖：16
  - [√] **16.2 L1.2：设计列表行布局**  
    说明：决定每行展示哪些字段（如 Name、Image、State、Status），并实现基础渲染。  
    依赖：16

- [√] **17 L2：数据加载与刷新**  
  说明：实现列表数据的首次加载与自动刷新。  
  依赖：16, 9
  - [√] **17.1 L2.1：在 Init 中加载容器列表**  
    说明：在列表视图初始化时调用 `docker.Client.ListContainers` 填充数据。  
    依赖：17
  - [√] **17.2 L2.2：实现自动刷新功能**  
    说明：采用自动定时刷新（默认3秒），支持通过快捷键 `a` 切换自动刷新开关，并显示刷新状态和上次刷新时间。  
    依赖：17
  - [√] **17.3 L2.3：处理加载中的状态显示**  
    说明：在加载过程展示 loading 文案，并在失败时通过全局错误区域提示。  
    依赖：17

- [√] **18 L3：列表交互**  
  说明：让用户可以在列表中移动选中项并跳转到详情视图。  
  依赖：17, 20
  - [√] **18.1 L3.1：实现上下移动选中逻辑**  
    说明：支持 `j/k` 或方向键移动选中行，保证边界安全处理。  
    依赖：18
  - [√] **18.2 L3.2：实现 Enter 跳转容器详情视图**  
    说明：在按下 Enter 时，将选中容器 ID 传递给详情视图并切换当前视图。  
    依赖：18

- [x] **19 L4：列表过滤与排序**  
  说明：提供基本过滤功能（如只看 running 容器）和可选的简单排序。  
  依赖：17
  - [x] **19.1 L4.1：实现按状态过滤**  
    说明：添加过滤条件（如 running、exited），通过快捷键或简单输入控制。  
    依赖：19
  - [x] **19.2 L4.2：实现按名称模糊搜索**  
    说明：支持用户输入关键字过滤容器名称，简化查找。  
    依赖：19

---

### 阶段 F：容器详情视图（V 系列）

- [x] **20 V1：详情数据结构与布局**  
  说明：为容器详情视图设计数据模型和展示布局。  
  依赖：15, 10
  - [x] **20.1 V1.1：定义 ContainerDetailModel**  
    说明：包含容器 ID、详情数据、加载状态、错误信息等字段。  
    依赖：20
  - [x] **20.2 V1.2：设计详情布局**  
    说明：将基础信息、端口、挂载、环境变量等分区展示，避免信息过于拥挤。  
    依赖：20

- [x] **21 V2：数据加载**  
  说明：实现详情视图的实际数据拉取逻辑。  
  依赖：20, 10
  - [x] **21.1 V2.1：在初始化时调用 ContainerDetails**  
    说明：在进入详情视图时调用 Docker 客户端获取详情数据并更新视图。  
    依赖：21
  - [x] **21.2 V2.2：处理加载失败和空状态**  
    说明：当容器已停止或不存在时，给出清晰提示并允许返回列表。  
    依赖：21

- [x] **22 V3：视图切换逻辑**  
  说明：实现详情视图与列表视图之间的返回与跳转。  
  依赖：20, 18
  - [x] **22.1 V3.1：从列表视图初始化详情 model**  
    说明：确保从列表视图跳转时正确传入容器 ID 并创建新的详情 model。  
    依赖：22
  - [x] **22.2 V3.2：实现返回列表的快捷键**  
    说明：在详情视图中通过 `Esc` 或 `b` 返回列表视图。  
    依赖：22

---

### 阶段 G：日志视图（G 系列）

- [✓] **23 G1：日志视图模型设计**  
  说明：为日志视图设计数据模型与布局。  
  依赖：15, 11
  - [✓] **23.1 G1.1：定义 LogViewModel**  
    说明：包括容器 ID、日志缓冲区、是否 follow、滚动位置等字段。  
    依赖：23
  - [✓] **23.2 G1.2：设计日志布局**  
    说明：顶部显示容器名/模式，中间滚动日志区域，底部显示快捷键提示。  
    依赖：23

- [✓] **24 G2：一次性日志加载**  
  说明：支持获取并展示最近 N 行日志。  
  依赖：23, 11
  - [✓] **24.1 G2.1：调用日志 API 获取最近 N 行**  
    说明：在日志视图初始化时调用 Docker 日志 API 获取最近 N 行记录。  
    依赖：24
  - [✓] **24.2 G2.2：实现日志滚动显示**  
    说明：支持通过快捷键上下滚动查看日志内容。  
    依赖：24

- [✓] **25 G3：follow 模式**  
  说明：支持实时跟随日志输出，类似 `docker logs -f`。  
  依赖：24
  - [✓] **25.1 G3.1：设计 follow 模式消息通道**  
    说明：使用 goroutine + channel 或 tea.Cmd 实现日志行向 UI 的推送。  
    依赖：25
  - [✓] **25.2 G3.2：实现开启/关闭 follow 的快捷键**  
    说明：添加 `f` 切换 follow 模式的逻辑。  
    依赖：25
  - [✓] **25.3 G3.3：处理容器停止或日志终止**  
    说明：在容器停止或日志流结束时给出提示，并自动退出 follow 模式。  
    依赖：25

- [✓] **26 G4：与其他视图集成**  
  说明：实现从列表/详情视图进入日志视图及返回的流程。  
  依赖：18, 22, 24
  - [✓] **26.1 G4.1：在列表视图中添加打开日志的快捷键**  
    说明：在列表中为选中容器添加 `l` 打开日志视图的逻辑。  
    依赖：26
  - [✓] **26.2 G4.2：在日志视图中实现返回逻辑**  
    说明：通过 `Esc` 或 `b` 返回之前的视图（列表或详情）。  
    依赖：26

---

### 阶段 H：容器 exec 交互式 shell（E 系列）

- [✓] **27 E1：交互策略设计**  
  说明：决定 exec shell 的用户体验模式（退出 TUI 后进入 shell，或在 TUI 内嵌）。  
  依赖：12, 15
  - [✓] **27.1 E1.1：评估两种交互方案的利弊**  
    说明：比较内嵌 shell 与暂时退出 TUI 的复杂度和可维护性，MVP 建议选择退出 TUI 模式。  
    依赖：27
  - [✓] **27.2 E1.2：设计用户交互流程**  
    说明：明确用户从列表/详情视图按 `s` 后的流程，包括提示、进入 shell、返回工具。  
    依赖：27

- [✓] **28 E2：ExecShell 调用实现**  
  说明：基于 Docker 客户端实现实际的 exec shell 调用。  
  依赖：12
  - [✓] **28.1 E2.1：在 Docker Client 中实现 ExecShell**  
    说明：完成 `ExecShell` 方法对 Docker SDK 的封装，处理命令和 IO 流。  
    依赖：28
  - [✓] **28.2 E2.2：处理 Windows 与容器 shell 兼容性**  
    说明：考虑容器中没有 `/bin/bash` 的情况，优先尝试 `/bin/sh` 或通过配置指定。  
    依赖：28

- [✓] **29 E3：TUI 与 exec 集成**  
  说明：在 TUI 中提供进入容器 shell 的快捷方式，并处理返回逻辑。  
  依赖：27, 28, 18, 22
  - [✓] **29.1 E3.1：在列表/详情视图中添加 exec 快捷键**  
    说明：为当前选中容器添加 `s` 启动 exec shell 的逻辑。  
    依赖：29
  - [✓] **29.2 E3.2：实现 TUI 与 shell 之间的模式切换**  
    说明：实现退出 TUI → 进入 shell → 退出 shell 后重新启动 TUI 的流程。  
    依赖：29
  - [✓] **29.3 E3.3：处理 exec 失败时的错误提示**  
    说明：在 exec 失败（容器不存在等）时通过全局错误区域提示用户。  
    依赖：29

---

### 阶段 H2：容器操作功能（O 系列）

- [✓] **30 O1：基础容器生命周期操作**  
  说明：实现容器的启动、停止、重启等基本操作。  
  依赖：9, 18
  - [✓] **30.1 O1.1：在 Docker Client 中实现操作方法**  
    说明：封装 Start、Stop、Restart 方法，处理错误和超时。  
    依赖：30
  - [✓] **30.2 O1.2：在容器列表视图添加操作快捷键**  
    说明：添加快捷键 `t`(Start)、`p`(Stop)、`R`(Restart)，仅对选中容器生效。  
    依赖：30
  - [✓] **30.3 O1.3：实现操作状态提示**  
    说明：操作执行时显示 loading 状态，完成后显示成功/失败消息，并自动刷新列表。  
    依赖：30

- [✓] **31 O2：容器删除操作**  
  说明：实现容器删除功能，包含确认对话框和批量删除。  
  依赖：30
  - [✓] **31.1 O2.1：实现 Remove 方法**  
    说明：在 Docker Client 中实现 Remove 方法，支持强制删除和删除关联卷。  
    依赖：31
  - [✓] **31.2 O2.2：实现确认对话框**  
    说明：删除前显示确认对话框，显示容器名称和警告信息，支持 y/ESC 确认/取消。  
    依赖：31
  - [✓] **31.3 O2.3：添加删除快捷键**  
    说明：在容器列表添加 `Ctrl+D` 快捷键触发删除，仅对已停止的容器生效。  
    依赖：31

- [ ] **32 O3：高级容器操作**  
  说明：实现暂停、重命名等高级操作。  
  依赖：30
  - [ ] **32.1 O3.1：实现 Pause/Unpause**  
    说明：封装暂停和恢复容器的方法，添加 `P` 快捷键。  
    依赖：32
  - [ ] **32.2 O3.2：实现批量操作**  
    说明：支持停止所有运行中的容器、删除所有已停止的容器等批量操作。  
    依赖：32
  - [ ] **32.3 O3.3：实现容器重命名**  
    说明：在详情视图添加重命名功能，弹出输入框输入新名称。  
    依赖：32

---

### 阶段 I：健壮性与用户体验（R 系列）

- [ ] **33 R1：错误处理与提示统一**  
  说明：统一项目中错误的封装与展示方式。  
  依赖：9, 10, 11, 12, 15
  - [ ] **33.1 R1.1：设计统一错误类型或包装函数**  
    说明：抽象网络错误、容器不存在等常见错误类型。  
    依赖：33
  - [ ] **33.2 R1.2：实现全局错误展示区域**  
    说明：在 UI 中预留底部 status bar 或提示区域，显示最近错误信息。  
    依赖：33
  - [ ] **33.3 R1.3：在关键路径中接入错误展示**  
    说明：在列表加载、详情加载、日志加载、exec 入口处统一调用错误展示逻辑。  
    依赖：33

- [✓] **34 R2：加载状态与空状态**  
  说明：提升在数据加载和无数据时的用户体验。  
  依赖：17, 21, 24
  - [✓] **34.1 R2.1：为各视图添加 loading 状态**  
    说明：在容器列表、详情、日志视图中增加加载中的视觉提示。  
    依赖：34
  - [✓] **34.2 R2.2：设计友好的空状态文案**  
    说明：在无容器、无日志等情况下展示说明性文本，而不是空白屏。  
    依赖：34

- [ ] **35 R3：性能与资源释放**  
  说明：避免 goroutine 泄漏和不必要的资源占用。  
  依赖：25, 13
  - [ ] **35.1 R3.1：确保日志 follow goroutine 正常退出**  
    说明：在离开日志视图或退出程序时，正确关闭 follow goroutine 和日志流。  
    依赖：35
  - [ ] **35.2 R3.2：确保 Docker Client 正常释放**  
    说明：在程序退出时关闭 Docker 客户端连接或相关资源。  
    依赖：35
  - [ ] **35.3 R3.3：验证频繁刷新下的资源占用**  
    说明：在本地环境压测频繁刷新列表场景，观察 CPU/内存占用并做必要优化。  
    依赖：35

---

### 阶段 J：打包与文档（P 系列）

- [ ] **36 P1：构建与运行脚本**  
  说明：简化在不同机器上编译和运行项目的流程。  
  依赖：5
  - [ ] **36.1 P1.1：编写构建脚本**  
    说明：为常用平台（至少当前开发环境）编写简单构建脚本（如 PowerShell 或 Makefile）。  
    依赖：36
  - [ ] **36.2 P1.2：验证本地二进制运行**  
    说明：使用构建脚本编译并在 Windows 环境运行，确认无基础错误。  
    依赖：36

- [ ] **37 P2：使用说明**  
  说明：为自己和潜在团队成员提供简要使用文档。  
  依赖：18, 26, 29, 30, 31
  - [ ] **37.1 P2.1：编写 MVP 使用说明**  
    说明：记录如何启动 docktui、如何查看容器列表、如何查看日志和进入 shell、如何操作容器（启动/停止/删除）、如何操作 docker-compose 项目。  
    依赖：37
  - [ ] **37.2 P2.2：记录已支持与未支持功能**  
    说明：列出当前 MVP 支持的功能（本地 Docker + docker-compose + 容器操作）和未来计划的功能，作为 roadmap 基础。  
    依赖：37

- [ ] **38 P3：预发布版本验证**  
  说明：在真实的本地开发环境中验证 MVP 的可用性。  
  依赖：36, 37, 33, 34, 35
  - [ ] **38.1 P3.1：完整走一遍核心用例**  
    说明：从启动工具到查看容器列表、详情、日志、进入 shell、操作容器（启动/停止/删除）、管理 docker-compose 项目全流程跑通。  
    依赖：38
  - [ ] **38.2 P3.2：记录反馈并更新计划**  
    说明：记录使用过程中的痛点与改进建议，回写到 PRD 或任务清单中，为下一轮迭代做准备。  
    依赖：38

---

### 阶段 K：docker-compose 支持（C 系列）

> **注意**: 首页已重构为导航中心，预留了 Compose 项目入口 `[p]`，待实现后启用。

- [ ] **36 C1：docker-compose 支持策略设计**  
  说明：明确本项目如何与 docker-compose 集成（命令行工具选择、参数约定、错误处理方式）。  
  依赖：2.3
  - [ ] **36.1 C1.1：检测本机 docker CLI 支持方式**  
    说明：实现检测逻辑，判断当前环境支持 `docker compose` 还是 `docker-compose`，并在配置中记录优先使用的命令。  
    依赖：36
  - [ ] **36.2 C1.2：定义统一的 Compose 命令封装接口**  
    说明：在合适的包中定义接口（如 `RunCompose(project, args...)`），内部通过 `os/exec` 调用 CLI，并统一处理 stdout/stderr/退出码。  
    依赖：36

- [ ] **37 C2：Compose 项目与配置模型**  
  说明：为 docker-compose 项目定义基础数据模型，并与配置模块关联。  
  依赖：6, 36
  - [ ] **37.1 C2.1：定义 ComposeProject 结构体**  
    说明：包含项目名称、路径、compose 文件列表、可选 env 文件、标签等字段，作为 UI 和命令调用的统一输入。  
    依赖：37
  - [ ] **37.2 C2.2：在配置中预留 compose 相关字段**  
    说明：在配置 struct 中增加 compose 相关配置（如忽略路径、默认 env 文件、默认命令超时），与现有配置加载逻辑集成。  
    依赖：37

- [ ] **38 C3：Compose 项目扫描**  
  说明：实现文件系统扫描，自动发现 docker-compose 项目。  
  依赖：37
  - [ ] **38.1 C3.1：实现 compose 文件扫描逻辑**  
    说明：从当前工作目录及子目录递归扫描 `docker-compose.yml` / `docker-compose.*.yml` 文件，将其归类为 ComposeProject。  
    依赖：38
  - [ ] **38.2 C3.2：实现扫描结果去重与忽略规则**  
    说明：根据配置中的忽略路径、隐藏规则，对扫描得到的项目进行过滤与去重。  
    依赖：38
  - [ ] **38.3 C3.3：提供刷新扫描的公共 API**  
    说明：封装函数供 UI 调用，以在运行时重新扫描 compose 项目列表。  
    依赖：38

- [ ] **39 C4：Compose 项目操作 API**  
  说明：基于 CLI 封装项目级操作（up/down/restart/logs 等）。  
  依赖：36, 38
  - [ ] **39.1 C4.1：实现 ProjectUp 调用**  
    说明：封装 `docker compose up -d`（或等价命令），支持传入项目路径和额外参数，返回标准化结果。  
    依赖：39
  - [ ] **39.2 C4.2：实现 ProjectDown/Restart/Logs 调用**  
    说明：封装 `down`、`restart`、`logs` 等操作，确保可被 UI 方便调用，并处理常见错误（如命令不存在、项目目录错误）。  
    依赖：39
  - [ ] **39.3 C4.3：定义操作结果与错误结构**  
    说明：为 compose 操作定义结果结构体（包含 stdout 片段、错误消息、退出码等），方便 UI 展示。  
    依赖：39

- [ ] **40 C5：Compose 项目视图（列表）**  
  说明：在 TUI 中提供 docker-compose 项目的列表视图。  
  依赖：15, 38, 39
  - [ ] **40.1 C5.1：定义 ComposeProjectListModel**  
    说明：在 UI 层定义保存 compose 项目列表、选中索引、加载状态、错误信息的 model。  
    依赖：40
  - [ ] **40.2 C5.2：实现列表布局与快捷键**  
    说明：实现项目列表渲染（显示名称、路径、服务数量等），支持 `j/k` 或方向键移动、`Enter` 进入详情、`u` up、`d` down、`l` 查看项目日志等快捷键。  
    依赖：40
  - [ ] **40.3 C5.3：在主 Model 中集成 Compose 视图**  
    说明：在主视图管理中加入 compose 视图，并在首页/全局快捷键中提供进入 compose 视图的入口。  
    依赖：40, 15

- [ ] **41 C6：Compose 与容器视图联动**  
  说明：实现从 compose 项目跳转到对应容器列表，以及容器视图按项目过滤。  
  依赖：9, 18, 38
  - [ ] **41.1 C6.1：实现按 Compose 项目过滤容器列表**  
    说明：基于容器名称或 label 规则，从 Docker 容器列表中筛选出属于某个 compose 项目的容器。  
    依赖：41
  - [ ] **41.2 C6.2：在 Compose 视图中添加跳转容器列表的快捷键**  
    说明：在 Compose 项目视图中添加快捷键（如 `c`），跳转到仅显示该项目容器的容器列表视图。  
    依赖：41

- [ ] **42 C7：本地开发友好能力与环境重置**  
  说明：为本地开发场景提供“开发模式配置”和“一键本地环境重置”。  
  依赖：37, 39, 9, 32
  - [ ] **42.1 C7.1：设计开发模式配置结构**  
    说明：定义可选字段（如附加 env 文件、额外 volume 映射、调试标志），并将其挂在 ComposeProject 或配置中。  
    依赖：42
  - [ ] **42.2 C7.2：实现带开发模式的 ProjectUp 逻辑**  
    说明：在调用 ProjectUp 时，根据开发模式配置拼接额外参数或 env，便于本地调试。  
    依赖：42
  - [ ] **42.3 C7.3：实现“一键本地环境重置”操作**  
    说明：封装停止容器、删除相关容器/网络/volume 并重新 `up` 的组合操作，与日志/错误展示机制集成。  
    依赖：42
